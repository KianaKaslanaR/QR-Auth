<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Auth</title> <!-- ä¿®æ”¹æ ‡é¢˜ä¸º "QR Auth" -->
  <style>
    body {
      background-image: url('background.jpg'); /* è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„è·¯å¾„ */
      background-size: cover; /* ä½¿èƒŒæ™¯å›¾ç‰‡è¦†ç›–æ•´ä¸ªé¡µé¢ */
      background-repeat: no-repeat; /* é˜²æ­¢èƒŒæ™¯å›¾ç‰‡é‡å¤æ˜¾ç¤º */
      font-family: Arial, sans-serif; /* è®¾ç½®å­—ä½“ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ */
      color: #333; /* è®¾ç½®æ–‡å­—é¢œè‰² */
      margin: 0; /* å»é™¤é»˜è®¤çš„å¤–è¾¹è· */
      padding: 20px; /* è®¾ç½®é¡µé¢å†…è¾¹è·ï¼Œä½¿å†…å®¹ä¸ç´§è´´è¾¹ç¼˜ */
    }

    p, h2 {
      display: inline; /* è®¾ç½®ä¸ºè¡Œå†…å…ƒç´ ï¼Œé¿å…æ¢è¡Œ */
      margin: 0; /* å»é™¤é»˜è®¤çš„å¤–è¾¹è· */
    }
  </style>
</head>
<body>
  <script>
    // è·å–URLä¸­çš„æŸ¥è¯¢å‚æ•°
    const urlParams = new URLSearchParams(window.location.search);
    // é€šè¿‡ 'key' å‚æ•°è·å–ä¼ å…¥çš„æ•°æ®
    const keyData = urlParams.get('key');
    // é€šè¿‡ 'dv_name' å‚æ•°è·å–ä¼ å…¥çš„è®¾å¤‡åç§°
    const deviceName = urlParams.get('dv_name');
    // è·å–æµè§ˆå™¨ä¿¡æ¯
    const browserInfo = {
      userAgent: window.navigator.userAgent,
    };
    // ç­›é€‰ç‰¹å®šUser Agent
    const user_agent = browserInfo.userAgent;
    if (user_agent.includes("com.alibaba.android.rimet")) {
      const dingTalkIndex = user_agent.indexOf("DingTalk");
      if (dingTalkIndex !== -1) {
        const buildIndex = user_agent.indexOf("Build/");
        const deviceInfo = buildIndex !== -1 ? user_agent.substring(buildIndex, user_agent.indexOf(";", buildIndex)) : "æœªçŸ¥è®¾å¤‡ä¿¡æ¯";
        const dingTalkInfo = user_agent.substring(dingTalkIndex);
        const versionIndex = dingTalkInfo.indexOf("DingTalk/") + 9; // 9 æ˜¯ "DingTalk/" çš„é•¿åº¦
        const version = versionIndex !== -1 ? dingTalkInfo.substring(versionIndex, dingTalkInfo.indexOf(")")) : "æœªçŸ¥ç‰ˆæœ¬";
        // è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯
        const osIndexStart = user_agent.indexOf("Linux; U; ") + 10; // 10 æ˜¯ "Linux; U; " çš„é•¿åº¦
        const osIndexEnd = user_agent.indexOf(";", osIndexStart);
        const osInfo = osIndexEnd !== -1 ? user_agent.substring(osIndexStart, osIndexEnd) : "æœªçŸ¥æ“ä½œç³»ç»Ÿ";
        // åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
        document.body.innerHTML += `<p>æ‚¨æ­£åœ¨ä½¿ç”¨${deviceInfo}è¿›è¡Œè®¤è¯æ“ä½œ</p>`;
        document.body.innerHTML += `<p>æ‚¨çš„æ“ä½œç³»ç»Ÿï¼š${osInfo}</p>`;
        document.body.innerHTML += `<p>æ‚¨çš„DingTalkç‰ˆæœ¬ï¼š${version}</p> <br><br>`;
        document.body.innerHTML += `<p>æ‚¨æ­£åœ¨ä¸º</p> <h2>${deviceName || 'æœªä¼ å…¥è®¾å¤‡åç§°'}</h2> <p>è¿›è¡Œè®¤è¯</p> <br>`;
        document.body.innerHTML += `<p>è®¤è¯å¯†é’¥ğŸ”:</p> <h2>${keyData || 'æœªä¼ å…¥key'}</h2>`;
      }
    } else {
      // å¦‚æœæœªæ£€æµ‹åˆ°ç‰¹å®šUser Agentï¼Œè·³è½¬åˆ° about:blank
      window.location.href = "about:blank";
    }
  </script>
</body>
</html>
